# -----------------------------------------------------------------------------
# 파일명: baseline.yaml
# 목적 : log-fore 시뮬레이터의 "기본 부하" 프로파일 설정
# 사용 : python -m simulator.main --profile simulator/profiles/baseline.yaml
# 오버라이드:
#   - --rps, --duration 으로 이 파일의 rps/duration_sec 값을 일시 변경 가능
#   - error_rate는 서비스별(dict) 또는 공통값(number)로 지정 가능
#
# 필드 설명:
#   - duration_sec : 전체 실행 시간(초)
#   - rps          : 기본 초당 생성 수(시간대 가중치/버스트로 변동)
#   - mix          : 서비스별 비율 합이 1.0이 되도록(auth/order/payment/notify)
#   - error_rate   : 서비스별 에러 비율(없으면 공통값/기본값 사용)
#   - bursts       : 특정 시점부터 rps를 해당 값으로 교체(우선순위 높음)
#   - time_weights : KST(Asia/Seoul) 기준 시간대별 rps 배수 범위 [min,max]
#   - weight_mode  : time_weights에서 multiplier를 고르는 방법 (uniform/mid/low/high)
#   - env          : 환경 라벨(필요 시 서비스 생성기에서 참조)
#
# 동작 우선순위(러너 구현 기준):
#   base rps --(time_weights 곱)--> rps_now --(bursts 적용 시 교체)--> 최종 rps
#   ※ bursts에 걸리면 해당 rps로 "교체"됨. (합성 로직 원하면 runner에서 변경)
# -----------------------------------------------------------------------------

duration_sec: 300          # 5분
rps: 600                   # 초당 600건(시간대 가중치/버스트로 변동)

mix:
  auth: 0.20
  order: 0.40
  payment: 0.30
  notify: 0.10

error_rate:
  auth: 0.01
  order: 0.02
  payment: 0.03
  notify: 0.005

bursts:
  - { at_sec: 60,  rps: 900 }   # 1분 시점부터 900 rps
  - { at_sec: 180, rps: 500 }   # 3분 시점부터 500 rps

time_weights:
  - { range: "0-7",   weight: [0.20, 0.40] }
  - { range: "8-11",  weight: [0.10, 0.30] }
  - { range: "12-13", weight: [0.05, 0.15] }
  - { range: "14-18", weight: [0.10, 0.30] }
  - { range: "19-23", weight: [0.15, 0.35] }

weight_mode: "uniform"
env: "dev"
